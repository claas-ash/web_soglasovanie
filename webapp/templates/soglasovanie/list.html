{% extends "base.html" %}

{% block content %}
    
<table class="table table-bordered table-hover">
  <thead class="thead-dark"> 
    <tr>
      <th scope="col" class="d-none d-sm-table-cell">Номер</th>
      <th scope="col">Бизнес процесс</th>
      <th scope="col" class="d-none d-sm-table-cell">Дата БП</th>
      <th scope="col">Наименование</th>
      <th scope="col">Договор</th>
      <th scope="col">Предмет договора</th>
      <th scope="col">Даты договора</th>
      <th scope="col">Сумма</th>
      <th scope="col" style="width: 170px; text-align: center;">Вердикт</th>
    </tr>
  </thead>
  <tbody>
      
      {% for task in list_of_tasks %} 

        <tr onclick="window.location='{{url_for('soglasovanie.show_task',task_id = task.task_id)}}'"
          {% if task.bp.date | is_earlier_than_n_days(3) %}
            class="table-warning"
          {% endif %}
        >
          <th scope="row" class="d-none d-sm-table-cell">{{task.task_id}}</th>
          <td >{{ task.bp.bp_id }}</td>
          <td class="d-none d-sm-table-cell"> {{task.bp.date | datetime_vl('%d.%m.%Y')}} </td>
          <td> {{ task.bp.title }} </td>
          <td> {{ task.bp.list_info1 }} </td>
          <td>
            {{ task.bp.list_info2 }}
            {% if task.bp.list_info3 == 1 %}
              (Рамочный)
            {% endif %}
          </td>
          <td>
            {{ task.bp.list_info4 }}
            {% if task.bp.list_info5 %}
              {{ task.bp.list_info5 }}
            {% endif %}
          </td>
          <td> {{ task.bp.list_info6 }} </td>
          <td  style="text-align: center;">
            {%if task.verdict %} 
              {% if task.verdict == 'success'%}
                <span class='badge badge-success'>Согласовано</span>
              {% elif task.verdict == 'mistake'%}
                <span class='badge badge-warning'>Отклонено</span>
              {% else %}
                <span class='badge badge-danger'>{{task.verdict}}</span>
              {% endif %}
              <br>
              {% if task.verdict_date%}
                {{task.verdict_date | datetime_vl}}
              {% endif %}
            {%endif%}
          </td>
        </tr>
      {% endfor %}

  </tbody>
</table>

{% endblock %}
